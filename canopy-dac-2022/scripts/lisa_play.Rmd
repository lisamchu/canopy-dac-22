---
title: "Canopy DAC Work"
author: "Lisa Chu"
date: "3/31/2022"
output: html_document
---

## File Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r import libraries}
library(here)
library(rio)
library(tidyverse)
library(janitor)
library(dplyr)
```

## Data Cleaning

```{r data import}
data <- read.csv("https://raw.githubusercontent.com/lisamchu/canopy-dac-22/master/canopy-dac-2022/data/Final%20Canopy%20Dataset%20for%20DAC%20-%20Final%20Data%203_22.csv")
```

Next, we want to make sure the variable names are clean and consistent. This code makes the variable names lowercase and words separated by underscores.

```{r clean names}
data <- data %>% 
  clean_names()
```

## Data Analysis

**Cycle 1 task: Which states are represented or not?**

```{r state frequency}
table_state <- setNames(as.data.frame(table(data$school_state)), c('States', 'Number of schools'))
table_state
```

**Cycle 1 task: What's the breakdown of schools in the data by locale (urban, suburban, rural)?**
Note: Not all reported their locale, only 33
```{r rural frequency}
table_rural <- setNames(as.data.frame(table(data$self_reported_locale_rural)), c('Locale', 'Number of Schools - Rural'))
rownames(table_rural) <- c('Non-rural', 'Rural')
table_rural
```

```{r suburban frequency}
table_suburban <- setNames(as.data.frame(table(data$self_reported_locale_suburban)), c('Locale', 'Number of Schools - Suburban'))
rownames(table_suburban) <- c('Non-suburban', 'Suburban')
table_suburban
```

```{r urban frequency}
table_urban <- setNames(as.data.frame(table(data$self_reported_locale_urban)), c('Locale', 'Number of Schools - Urban'))
rownames(table_urban) <- c('Non-urban', 'Urban')
table_urban
```

```{r merge with by - locale}
Reduce(function(...) merge(..., all=TRUE, by="Locale"),
       list(table_rural, table_suburban, table_urban))
```

```{r}
bar_locale <- table(data$self_reported_locale_rural)
barplot(bar_locale, main="Locale", 
        xlab="Number of schools")
```

**Cycle 1 task: What's the breakdown of schools in the data by level (elementary, middle, high)?**

```{r create school_type variable}
data %>% mutate(school_type = case_when(school_descriptor_district == 1 ~ 'district',
                                        school_descriptor_charter == 1 ~ 'charter',
                                        school_descriptor_independent == 1 ~'independent',
                                        school_descriptor_sws == 1|school_descriptor_virtual == 1|school_descriptor_microschool == 1|school_descriptor_homeschool == 1|school_descriptor_hub == 1|school_descriptor_other == 1~'other'))
```

**Cycle 1 task: What's the breakdown of schools in the data by school type (charter, district, independent)?**

```{r create school_type variable}
data %>% mutate(school_type = case_when(school_descriptor_district == 1 ~ 'district',
                                        school_descriptor_charter == 1 ~ 'charter',
                                        school_descriptor_independent == 1 ~'independent',
                                        school_descriptor_sws == 1|school_descriptor_virtual == 1|school_descriptor_microschool == 1|school_descriptor_homeschool == 1|school_descriptor_hub == 1|school_descriptor_other == 1~'other'))
```

